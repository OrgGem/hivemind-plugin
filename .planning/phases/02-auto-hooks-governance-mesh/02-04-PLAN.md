---
phase: 02-auto-hooks-governance-mesh
plan: 04
type: execute
wave: 3
depends_on: ["02-02", "02-03"]
files_modified:
  - src/schemas/brain-state.ts
  - src/lib/detection.ts
  - src/hooks/soft-governance.ts
  - src/hooks/session-lifecycle.ts
  - tests/evidence-gate.test.ts
  - tests/soft-governance.test.ts
  - tests/governance-stress.test.ts
autonomous: true

must_haves:
  truths:
    - "After 10+ unacknowledged warning cycles, governance escalates to IGNORED tier with explicit argue-back"
    - "IGNORED argue-back cites live hierarchy/metric evidence instead of static generic text"
    - "All 13 stress conditions for governance mesh evaluate PASS in automated test output"
  artifacts:
    - path: "src/lib/detection.ts"
      provides: "IGNORED escalation tier + evidence formatting support"
      contains: "IGNORED"
    - path: "src/schemas/brain-state.ts"
      provides: "State fields for unacknowledged warning accounting"
      contains: "unacknowledged"
    - path: "tests/governance-stress.test.ts"
      provides: "13-condition governance stress validation"
      min_lines: 120
  key_links:
    - from: "src/hooks/soft-governance.ts"
      to: "src/schemas/brain-state.ts"
      via: "increment/reset warning-ack counters based on tool behavior"
      pattern: "unacknowledged"
    - from: "src/hooks/session-lifecycle.ts"
      to: "src/lib/detection.ts"
      via: "render escalated IGNORED signal block with dynamic evidence"
      pattern: "formatSignals"
---

<objective>
Add IGNORED-tier escalation and lock down phase success through a dedicated governance stress suite.

Purpose: Complete GOV-08 and verify the full GOV-01..08 behavior chain under stress-level scenarios, including ST11/ST12 fixes.

Output: Detection/state updates for ignored-warning escalation plus 13-condition automated governance stress tests.
</objective>

<execution_context>
@/Users/apple/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/apple/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-auto-hooks-governance-mesh/02-RESEARCH.md
@docs/plans/STRESS-TEST-1.MD

@src/lib/detection.ts
@src/schemas/brain-state.ts
@src/hooks/soft-governance.ts
@src/hooks/session-lifecycle.ts
@tests/evidence-gate.test.ts
@tests/soft-governance.test.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement IGNORED-tier escalation from unacknowledged warning cycles</name>
  <files>src/schemas/brain-state.ts, src/lib/detection.ts, src/hooks/soft-governance.ts, src/hooks/session-lifecycle.ts, tests/evidence-gate.test.ts, tests/soft-governance.test.ts</files>
  <action>Add unacknowledged-warning counter fields to brain state and update soft-governance tracking so counters increase when warning conditions persist without acknowledgment, and reset on explicit acknowledgment actions (at minimum `map_context` and `export_cycle`; include any additional reset paths you define in code comments). Extend escalation model with `IGNORED` tier for 10+ unacknowledged warning cycles and render dynamic argue-back using current hierarchy + metrics evidence in prompt output.</action>
  <verify>Run `npx tsx --test tests/evidence-gate.test.ts` and `npx tsx --test tests/soft-governance.test.ts`.</verify>
  <done>Warnings persistently ignored now escalate to IGNORED tier with data-backed argue-back; counters and reset behavior are deterministic and tested.</done>
</task>

<task type="auto">
  <name>Task 2: Add governance stress suite with 13 pass/fail conditions</name>
  <files>tests/governance-stress.test.ts</files>
  <action>Create `tests/governance-stress.test.ts` that evaluates 13 governance stress conditions from `STRESS-TEST-1.MD` and Phase 2 success criteria, including assisted turn-1 teaching (ST12), permissive silent-pressure behavior (ST11), toast signal paths, session.idle stale trigger, framework detection matrix, phase-goal-aware drift guidance, and IGNORED-tier escalation behavior. Output explicit PASS/FAIL lines per condition for fast diagnosis.</action>
  <verify>Run `npx tsx --test tests/governance-stress.test.ts` and confirm all 13 checks pass.</verify>
  <done>Automated stress harness reports 13/13 PASS and provides per-condition evidence for governance mesh readiness.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. `npx tsx --test tests/evidence-gate.test.ts` passes with IGNORED-tier assertions
3. `npx tsx --test tests/soft-governance.test.ts` passes with acknowledgment counter behavior
4. `npx tsx --test tests/governance-stress.test.ts` reports 13/13 PASS
5. `npm test` passes end-to-end
</verification>

<success_criteria>
- GOV-08 satisfied: IGNORED tier triggers at 10+ unacknowledged warning cycles with dynamic argue-back
- Phase 2 stress objective satisfied: all 13 governance stress conditions are automated and PASS
- ST11/ST12 regressions prevented by dedicated stress assertions
</success_criteria>

<output>
After completion, create `.planning/phases/02-auto-hooks-governance-mesh/02-04-SUMMARY.md`
</output>
