---
phase: 02-auto-hooks-governance-mesh
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/hooks/session-lifecycle.ts
  - tests/integration.test.ts
  - tests/soft-governance.test.ts
autonomous: true

must_haves:
  truths:
    - "Bootstrap teaching appears on turn 0 in strict, assisted, and permissive modes"
    - "Evidence-discipline and team-behavior guidance are injected from turn 0 regardless of governance status"
    - "Permissive mode keeps silent tracking behavior by suppressing non-info warning pressure in system prompt"
  artifacts:
    - path: "src/hooks/session-lifecycle.ts"
      provides: "Turn-window bootstrap and mode-aware prompt signal rendering"
      contains: "turn_count <= 2"
    - path: "tests/integration.test.ts"
      provides: "Turn-0 bootstrap behavior coverage across governance modes"
      contains: "bootstrap"
    - path: "tests/soft-governance.test.ts"
      provides: "Permissive-mode warning pressure regression coverage"
      contains: "permissive"
  key_links:
    - from: "src/hooks/session-lifecycle.ts"
      to: "src/lib/detection.ts"
      via: "compileEscalatedSignals + mode-specific filtering"
      pattern: "compileEscalatedSignals"
    - from: "src/hooks/session-lifecycle.ts"
      to: "bootstrap block output"
      via: "turn-window gating independent from governance_status"
      pattern: "turn_count <= 2"
---

<objective>
Rework governance prompt semantics so turn-0 teaching and evidence discipline fire in every mode without violating permissive silent-tracking behavior.

Purpose: Close GOV-01, GOV-02, and GOV-03 by removing lock-status coupling and applying mode-aware warning pressure at render time.

Output: Updated `session-lifecycle` prompt compiler and test coverage proving strict/assisted/permissive behavior from first turns.
</objective>

<execution_context>
@/Users/apple/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/apple/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-auto-hooks-governance-mesh/02-RESEARCH.md

@src/hooks/session-lifecycle.ts
@src/lib/detection.ts
@tests/integration.test.ts
@tests/soft-governance.test.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Make bootstrap and teaching turn-window based across all modes</name>
  <files>src/hooks/session-lifecycle.ts</files>
  <action>Update bootstrap gating to use only turn window (`turn_count <= 2`) instead of `governance_status === "LOCKED"`, so strict/assisted/permissive all receive initial teaching. Keep mode-specific copy (strict can keep stronger wording), but do not suppress bootstrap content in permissive mode. Ensure evidence-discipline and team behavior guidance are emitted from turn 0 as part of the same bootstrap path.</action>
  <verify>Run `npx tsx --test tests/integration.test.ts` and confirm turn-0 bootstrap assertions pass for strict, assisted, and permissive scenarios.</verify>
  <done>Prompt injection includes bootstrap + evidence/team teaching on first turns in all modes; behavior no longer depends on lock status.</done>
</task>

<task type="auto">
  <name>Task 2: Apply permissive-mode warning suppression at signal render layer</name>
  <files>src/hooks/session-lifecycle.ts, tests/soft-governance.test.ts, tests/integration.test.ts</files>
  <action>Keep detection counters running in all modes, but suppress WARN/CRITICAL/DEGRADED alert rendering in permissive mode to match silent-tracking docs (retain INFO-level guidance only). Add or update tests that prove permissive still tracks metrics while prompt output omits high-pressure warning tiers.</action>
  <verify>Run `npx tsx --test tests/soft-governance.test.ts` and `npx tsx --test tests/integration.test.ts`.</verify>
  <done>Permissive mode continues metric collection but no longer shows non-info detection pressure in system prompt output.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. `npx tsx --test tests/integration.test.ts` passes with updated turn-0 semantics
3. `npx tsx --test tests/soft-governance.test.ts` passes with permissive tracking + silent-pressure behavior
</verification>

<success_criteria>
- GOV-01 satisfied: bootstrap triggers in all governance modes with turn-window gate
- GOV-02 satisfied: evidence/team guidance appears from turn 0 unconditionally
- GOV-03 satisfied: permissive mode suppresses warning-pressure rendering while keeping silent tracking
</success_criteria>

<output>
After completion, create `.planning/phases/02-auto-hooks-governance-mesh/02-01-SUMMARY.md`
</output>
